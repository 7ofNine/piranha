SET(PYRANHA_INSTALL_PATH ${PYTHON_MODULES_PATH}/pyranha)

MACRO(PYTHONCMOD arg1)
  SET_TARGET_PROPERTIES(${arg1} PROPERTIES PREFIX "")
  IF(PYDEXTENSION)
    SET_TARGET_PROPERTIES(${arg1} PROPERTIES SUFFIX ".pyd")
  ENDIF(PYDEXTENSION)
  TARGET_LINK_LIBRARIES(${arg1} ${MANDATORY_LIBRARIES} ${PYTHON_LIBRARIES} ${BOOST_PYTHON_LIBRARY} ${ARGN})
  STRING(REGEX REPLACE "^_" "" DIR_ARG ${arg1})
  INSTALL(TARGETS ${arg1}
    RUNTIME DESTINATION ${PYRANHA_INSTALL_PATH}/${DIR_ARG}
    LIBRARY DESTINATION ${PYRANHA_INSTALL_PATH}/${DIR_ARG}
  )
  SET(MODULE_NAME ${arg1})
  CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/../__init__.py.template
    ${CMAKE_CURRENT_SOURCE_DIR}/__init__.py)
  INSTALL(FILES __init__.py DESTINATION ${PYRANHA_INSTALL_PATH}/${DIR_ARG})
ENDMACRO(PYTHONCMOD)

# Mandatory targets
ADD_SUBDIRECTORY(Core)

# Optional targets
IF(BUILD_PYRANHA_NP)
  ADD_SUBDIRECTORY(Np)
  ADD_SUBDIRECTORY(Npc)
ENDIF(BUILD_PYRANHA_NP)

IF(BUILD_PYRANHA_LNP)
  ADD_SUBDIRECTORY(Lnp)
  ADD_SUBDIRECTORY(Lnpc)
ENDIF(BUILD_PYRANHA_LNP)

IF(BUILD_PYRANHA_SP)
  ADD_SUBDIRECTORY(Sp)
#  ADD_SUBDIRECTORY(Spc)
ENDIF(BUILD_PYRANHA_SP)

IF(BUILD_PYRANHA_GUI)
  ADD_SUBDIRECTORY(Gui)
ENDIF(BUILD_PYRANHA_GUI)

INSTALL(FILES __init__.py DESTINATION ${PYRANHA_INSTALL_PATH})
